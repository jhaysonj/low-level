#!/usr/bin/python

import pwn

#input
username = str(raw_input("[!] Insert the username that you want to use: "))

# Serial logic
num = (ord(username[3]) ^ 0x1337) + 6221293

for char in username:
    if char == ' ':
        print("lol")
        exit(3)

    if char == '\n':
        continue

    num = num + (ord(char) ^ num) % 1337

# Printing out the serial generated for the inputed username
print("[!] Serial: " + str(num))

 # Starting process
p = pwn.process("/levels/lab01/lab1A")

# Sending payload
p.sendline(username)

p.sendline(str(num))

# Give the user the shell
p.interactive()

# Close the program
p.close()
